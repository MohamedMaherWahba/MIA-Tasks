# Untitled

# **MPU6050 Sensor Yaw Angle Measurement**

---

This Arduino code is designed to measure the yaw angle of an MPU6050 sensor using the raw accelerometer and gyro data. It uses the I2C communication protocol to interface with the sensor and the `Wire.h` library for I2C communication.

## **Code Overview**

The code consists of two functions:

- `setup()`: This function is called once during the setup of the Arduino board and is used to initialize the communication with the sensor and the serial communication.
- `loop()`: This function is called repeatedly after the `setup()` function has completed and is responsible for reading the raw accelerometer and gyro data from the sensor, converting the gyro data to degrees per second, integrating it over time to obtain the yaw angle, and printing the yaw angle to the serial monitor.

## **Code Breakdown**

### **Constants:**

- `MPU_addr`: This constant stores the I2C address of the MPU6050 sensor.

### **Variables:**

- `accel_x`, `accel_y`, `accel_z`: These variables store the raw accelerometer data for the x, y, and z axes, respectively.
- `gyro_x`, `gyro_y`, `gyro_z`: These variables store the raw gyro data for the x, y, and z axes, respectively.
- `yaw_angle`: This variable stores the yaw angle (in degrees).

### **`setup()` Function**

The `setup()` function is called once at the beginning of the program and is responsible for initializing the communication with the sensor and the serial communication. The function performs the following tasks:

- Initializes the I2C communication using `Wire.begin()`.
- Starts a transmission to the MPU6050 sensor using `Wire.beginTransmission(MPU_addr)`.
- Writes to the `PWR_MGMT_1` register of the MPU6050 sensor using `Wire.write(0x6B)` and sets it to zero (which wakes up the MPU6050 sensor) using `Wire.write(0)`.
- Ends the transmission to the sensor using `Wire.endTransmission(true)`.
- Initializes the serial communication using `Serial.begin(9600)`.

### **`loop()` Function**

The `loop()` function is called repeatedly after the `setup()` function has completed. The function performs the following tasks:

- Starts a transmission to the MPU6050 sensor using `Wire.beginTransmission(MPU_addr)`.
- Writes to the starting register of the accelerometer and gyro data using `Wire.write(0x3B)`.
- Ends the transmission to the sensor (but leaves the connection active) using `Wire.endTransmission(false)`.
- Requests a total of 14 registers (accelerometer and gyro data) from the sensor using `Wire.requestFrom(MPU_addr,14,true)`.
- Reads the high and low bytes of the x, y, and z-axis accelerometer data and combines them into a single 16-bit integer for each axis using `accel_x=Wire.read()<<8|Wire.read()`, `accel_y=Wire.read()<<8|Wire.read()`, and `accel_z=Wire.read()<<8|Wire.read()`.
- Reads the high and low bytes of the x, y, and z-axis gyro data and combines them into a single 16-bit integer for each axis using `gyro_x=Wire.read()<<8|Wire.read()`, `gyro_y=Wire.read()<<8|Wire.read()`, and `gyro_z=Wire.read()<<8|Wire.read()`.
- Converts the raw gyro data for the z-axis to degrees per second using `float gyro_rate_z = (float)gyro_z / 131.0`, where 131.0 is a sensitivity factor provided by the MPU6050 datasheet.
- Integrates the gyro rate over time to obtain the yaw angle using `yaw_angle += gyro_rate_z * 0.01`, where 0.01 is the time interval (in seconds) between updates.
- Prints the yaw angle (in degrees) to the serial monitor using `Serial.print("Yaw angle: ")` and `Serial.println(yaw_angle)`.
- Delays for 10ms using `delay(10)` to ensure a 100Hz update rate.

---

---

---

# Question answer

When working in a loud environment, applying a filter to the sensor data can help decrease the influence of noise and enhance the accuracy of the MPU6050 sensor readings. The low-pass filter is a popular type of filter that enables low-frequency signals to pass through while attenuating high-frequency noise.

The datasheet for the MPU6050 sensor includes a recommended cutoff frequency for the low-pass filter. You may regulate the trade-off between noise reduction and responsiveness to changes in measured values by setting the cutoff frequency.

The low-pass filter cutoff frequency, according to the MPU6050 datasheet, may be changed using the DLPF (Digital Low Pass Filter) option in the MPU6050's configuration register. The DLPF option allows you to select from a number of pre-defined cutoff frequencies, as indicated in the table below:

| DLPF_CFG | Accelerometer Bandwidth | Gyroscope Bandwidth | Delay |
| --- | --- | --- | --- |
| 0 | 260 Hz | 256 Hz | 0 ms |
| 1 | 184 Hz | 188 Hz | 2.0 ms |
| 2 | 94 Hz | 98 Hz | 3.0 ms |
| 3 | 44 Hz | 42 Hz | 4.9 ms |
| 4 | 21 Hz | 20 Hz | 8.5 ms |
| 5 | 10 Hz | 10 Hz | 13.8 ms |
| 6 | 5 Hz | 5 Hz | 19.0 ms |
| 7 | -- Reserved -- | -- Reserved -- | -- N/A -- |

To select an acceptable cutoff frequency, you must examine the properties of the signals you wish to monitor as well as the noise in your surroundings. In general, if the signals you're interested in have frequencies below a specific threshold, you should set the cutoff frequency slightly beyond that threshold to maintain the signal while attenuating noise. However, setting the cutoff frequency too low might induce delays and degrade the responsiveness of the sensor data.

It is best to begin with a moderate cutoff frequency and then change it based on your personal needs and the noise characteristics of your area. To get the best mix of noise reduction and responsiveness, you may need to experiment with different cutoff frequencies.

Keep in mind that noise reduction is only one component of sensor data processing. To increase the accuracy and dependability of your readings, you may need to explore alternative strategies such as sensor calibration, sensor fusion algorithms, or extra filtering methods, depending on your application.